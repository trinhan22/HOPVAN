<style>
    /* --- GI·ªÆ NGUY√äN CSS PREMIUM C·ª¶A B·∫†N --- */
    :root {
        --sb-w: 260px;
        --sb-primary: #FF8F50;
        --sb-gradient: linear-gradient(135deg, #FF8F50, #FF5E62);
        --sb-glass: rgba(255, 255, 255, 0.7);
        --sb-border: rgba(255, 255, 255, 0.8);
    }
    .sidebar-comp {
        width: var(--sb-w); height: 100vh; background: var(--sb-glass); backdrop-filter: blur(35px);
        border-right: 1px solid var(--sb-border); display: flex; flex-direction: column; padding: 40px 20px;
        position: fixed; top: 0; left: 0; z-index: 1000; font-family: 'Plus Jakarta Sans', sans-serif;
    }
    .sb-logo { display: flex; align-items: center; gap: 14px; margin-bottom: 50px; text-decoration: none; }
    .sb-logo span { font-size: 1.6rem; font-weight: 900; background: var(--sb-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .sb-list { list-style: none; padding: 0; margin: 0; flex: 1; display: flex; flex-direction: column; gap: 10px; }
    .sb-link { display: flex; align-items: center; gap: 15px; padding: 14px 20px; border-radius: 20px; color: #636E72; font-weight: 700; font-size: 0.95rem; text-decoration: none; transition: 0.3s; }
    .sb-link:hover { background: rgba(255, 143, 80, 0.08); color: var(--sb-primary); transform: translateX(8px); }
    .sb-link.active { background: var(--sb-gradient); color: white !important; box-shadow: 0 10px 25px rgba(255, 94, 98, 0.3); }
    .sb-footer { display: flex; flex-direction: column; gap: 12px; margin-top: auto; }
    .btn-fb-new { background: #fff5ec; border: 1.5px solid var(--sb-primary); color: var(--sb-primary); font-size: 0.85rem; font-weight: 700; padding: 12px; border-radius: 16px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn-logout-new { background: rgba(255, 94, 98, 0.05); color: #FF5E62; font-size: 1.1rem; font-weight: 800; padding: 16px; border-radius: 20px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; border: none; }
    .modal-fb-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.4); z-index: 20001; justify-content: center; align-items: center; backdrop-filter: blur(8px); }
    .modal-fb-box { background: white; padding: 40px; border-radius: 35px; width: 90%; max-width: 480px; position: relative; animation: modalPop 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
    .modal-fb-close { position: absolute; top: 25px; right: 30px; font-size: 1.5rem; cursor: pointer; color: #ccc; }
</style>

<div id="sb-overlay" style="position: fixed; inset: 0; background: rgba(0,0,0,0.2); backdrop-filter: blur(4px); z-index: 999; display: none;"></div>

<aside class="sidebar-comp" id="main-sidebar">
    <a href="index.html" class="sb-logo">
        <img src="../LOGO.WEBP" alt="Logo" style="width:40px">
        <span>HOPVAN</span>
    </a>

    <nav class="sb-list">
        <a href="index.html" class="sb-link" data-id="overview"><i class="fas fa-home"></i> T·ªïng quan</a>
        <a href="bantinvanhoc.html" class="sb-link" data-id="news"><i class="fas fa-newspaper"></i> B·∫£n tin</a>
        <a href="congdong.html" class="sb-link" data-id="community"><i class="fas fa-users"></i> C·ªông ƒë·ªìng</a>
        <a href="phongluyende.html" class="sb-link" data-id="practice"><i class="fas fa-pen-nib"></i> Luy·ªán ƒë·ªÅ</a>
        <a href="nhatkyhoctap.html" class="sb-link" data-id="journal"><i class="fas fa-book-journal-whills"></i> Nh·∫≠t k√Ω</a>
    </nav>

    <div class="sb-footer">
        <button id="btn-fb-trigger" class="btn-fb-new"><i class="fas fa-comment-dots"></i> G√≥p √Ω</button>
        <button id="btn-logout-trigger" class="btn-logout-new"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</button>
    </div>
</aside>

<div id="modal-feedback-menu" class="modal-fb-overlay">
    <div class="modal-fb-box">
        <span id="close-fb-menu" class="modal-fb-close">&times;</span>
        <h3 style="margin-bottom: 10px; color: #2D3436; font-weight: 800; font-size: 1.5rem;">üíå G√≥p √Ω cho Hopvan</h3>
        <form id="formspree-menu" action="https://formspree.io/f/mqeepqew" method="POST">
            <textarea name="message" rows="4" required style="width: 100%; padding: 18px; border: 1.5px solid #eee; border-radius: 20px; margin-bottom: 20px; outline: none; resize: none;" placeholder="B·∫°n mu·ªën chia s·∫ª ƒëi·ªÅu g√¨..."></textarea>
            <button type="submit" id="btn-submit-fb" style="width: 100%; padding: 16px; background: var(--sb-gradient); color: white; border: none; border-radius: 18px; font-weight: 800;">G·ª≠i √Ω ki·∫øn ngay</button>
        </form>
    </div>
</div>

<script>
    (function() {
        // 1. L·∫•y ƒë·ªãa ch·ªâ URL hi·ªán t·∫°i
        const path = window.location.pathname.toLowerCase();
        const links = document.querySelectorAll('.sb-link');
        
        let matchedId = null;

        // 2. LOGIC ∆ØU TI√äN: Ki·ªÉm tra c√°c trang chuy√™n bi·ªát tr∆∞·ªõc
        // Ch·ªâ c·∫ßn URL ch·ª©a t·ª´ kh√≥a n√†y th√¨ g√°n ID t∆∞∆°ng ·ª©ng
        if (path.includes('congdong')) {
            matchedId = 'community';
        } 
        else if (path.includes('phongluyende')) {
            matchedId = 'practice';
        } 
        else if (path.includes('bantinvanhoc')) {
            matchedId = 'news';
        } 
        else if (path.includes('nhatkyhoctap')) {
            matchedId = 'journal';
        } 
        // Cu·ªëi c√πng m·ªõi x√©t ƒë·∫øn trang ch·ªß/t·ªïng quan
        else if (path.includes('index') || path.includes('dashboard') || path === '/' || path.endsWith('/')) {
            matchedId = 'overview';
        }

        // 3. √Åp d·ª•ng class Active (X√≥a h·∫øt r·ªìi m·ªõi th√™m c√°i ƒë√∫ng)
        links.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('data-id') === matchedId) {
                link.classList.add('active');
            }
        });

        // --- GI·ªÆ NGUY√äN C√ÅC S·ª∞ KI·ªÜN N√öT B·∫§M C·ª¶A B·∫†N ---
        const modal = document.getElementById('modal-feedback-menu');
        const btnFb = document.getElementById('btn-fb-trigger');
        if(btnFb) btnFb.onclick = () => modal.style.display = 'flex';
        
        const closeFb = document.getElementById('close-fb-menu');
        if(closeFb) closeFb.onclick = () => modal.style.display = 'none';

        const form = document.getElementById('formspree-menu');
        if(form) {
            form.onsubmit = async (e) => {
                e.preventDefault();
                const btn = document.getElementById('btn-submit-fb');
                btn.innerText = "ƒêang g·ª≠i...";
                await fetch(e.target.action, { method: 'POST', body: new FormData(e.target), headers: { 'Accept': 'application/json' } });
                alert("C·∫£m ∆°n b·∫°n! ‚ù§Ô∏è");
                e.target.reset(); modal.style.display = 'none'; btn.innerText = "G·ª≠i ngay";
            };
        }

        const btnLogout = document.getElementById('btn-logout-trigger');
        if(btnLogout) {
            btnLogout.onclick = () => {
                if(confirm("B·∫°n mu·ªën ƒëƒÉng xu·∫•t kh·ªèi Hopvan?")) {
                    window.dispatchEvent(new Event('trigger-firebase-signout'));
                    setTimeout(() => { window.location.href = "../index.html"; }, 500);
                }
            };
        }
    })();
</script>